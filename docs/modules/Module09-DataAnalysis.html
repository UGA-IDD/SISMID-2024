<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.510">

  <meta name="author" content="Amy Winter">
  <meta name="author" content="Zane Billings">
  <title>SISMID Module NUMBER Materials (2025) - Module 9: Data Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Module 9: Data Analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://publichealth.uga.edu/faculty-member/amy-k-winter/">Amy Winter</a> <a href="https://orcid.org/0000-0003-2737-7003" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://wzbillings.com/">Zane Billings</a> <a href="https://orcid.org/0000-0002-0184-6134" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
</div>
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives</h2>
<p>After module 9, you should be able to…</p>
<ul>
<li>Descriptively assess association between two variables</li>
<li>Compute basic statistics</li>
<li>Fit a generalized linear model</li>
</ul>
</section>
<section id="import-data-for-this-module" class="slide level2">
<h2>Import data for this module</h2>
<p>Let’s read in our data (again) and take a quick look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data/serodata.csv"</span>) <span class="co">#relative path</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">head</span>(<span class="at">x=</span>df, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  observation_id IgG_concentration age gender     slum
1           5772         0.3176895   2 Female Non slum
2           8095         3.4368231   4 Female Non slum
3           9784         0.3000000   4   Male Non slum</code></pre>
</div>
</div>
</section>
<section id="prep-data" class="slide level2">
<h2>Prep data</h2>
<p>Create <code>age_group</code> three level factor variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>df<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>age <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"young"</span>, </span>
<span id="cb3-2"><a href="#cb3-2"></a>                       <span class="fu">ifelse</span>(df<span class="sc">$</span>age<span class="sc">&lt;=</span><span class="dv">10</span> <span class="sc">&amp;</span> df<span class="sc">$</span>age<span class="sc">&gt;</span><span class="dv">5</span>, <span class="st">"middle"</span>, <span class="st">"old"</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>df<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>age_group, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"young"</span>, <span class="st">"middle"</span>, <span class="st">"old"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create <code>seropos</code> binary variable representing seropositivity if antibody concentrations are &gt;10 IU/mL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>df<span class="sc">$</span>seropos <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>IgG_concentration<span class="sc">&lt;</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grouped-analyses" class="slide level2">
<h2>Grouped analyses</h2>
<ul>
<li>Most of this module will discuss statistical analyses. But first we’ll discuss doing univariate analyses we’ve already used on multiple groups.</li>
<li>We can use the <code>aggregate()</code> function to do many analyses across groups.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>?aggregate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(printr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'printr':
  method                from     
  knit_print.data.frame rmarkdown</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>?aggregate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compute Summary Statistics of Data Subsets

Description:

     Splits the data into subsets, computes summary statistics for
     each, and returns the result in a convenient form.

Usage:

     aggregate(x, ...)
     
     ## Default S3 method:
     aggregate(x, ...)
     
     ## S3 method for class 'data.frame'
     aggregate(x, by, FUN, ..., simplify = TRUE, drop = TRUE)
     
     ## S3 method for class 'formula'
     aggregate(x, data, FUN, ...,
               subset, na.action = na.omit)
     
     ## S3 method for class 'ts'
     aggregate(x, nfrequency = 1, FUN = sum, ndeltat = 1,
               ts.eps = getOption("ts.eps"), ...)
     
Arguments:

       x: an R object.  For the 'formula' method a 'formula', such as
          'y ~ x' or 'cbind(y1, y2) ~ x1 + x2', where the 'y' variables
          are numeric data to be split into groups according to the
          grouping 'x' variables (usually factors).

      by: a list of grouping elements, each as long as the variables in
          the data frame 'x', or a formula.  The elements are coerced
          to factors before use.

     FUN: a function to compute the summary statistics which can be
          applied to all data subsets.

simplify: a logical indicating whether results should be simplified to
          a vector or matrix if possible.

    drop: a logical indicating whether to drop unused combinations of
          grouping values.  The non-default case 'drop=FALSE' has been
          amended for R 3.5.0 to drop unused combinations.

    data: a data frame (or list) from which the variables in the
          formula should be taken.

  subset: an optional vector specifying a subset of observations to be
          used.

na.action: a function which indicates what should happen when the data
          contain 'NA' values. The default is to ignore missing values
          in the given variables.

nfrequency: new number of observations per unit of time; must be a
          divisor of the frequency of 'x'.

 ndeltat: new fraction of the sampling period between successive
          observations; must be a divisor of the sampling interval of
          'x'.

  ts.eps: tolerance used to decide if 'nfrequency' is a sub-multiple of
          the original frequency.

     ...: further arguments passed to or used by methods.

Details:

     'aggregate' is a generic function with methods for data frames and
     time series.

     The default method, 'aggregate.default', uses the time series
     method if 'x' is a time series, and otherwise coerces 'x' to a
     data frame and calls the data frame method.

     'aggregate.data.frame' is the data frame method.  If 'x' is not a
     data frame, it is coerced to one, which must have a non-zero
     number of rows.  Then, each of the variables (columns) in 'x' is
     split into subsets of cases (rows) of identical combinations of
     the components of 'by', and 'FUN' is applied to each such subset
     with further arguments in '...' passed to it.  The result is
     reformatted into a data frame containing the variables in 'by' and
     'x'.  The ones arising from 'by' contain the unique combinations
     of grouping values used for determining the subsets, and the ones
     arising from 'x' the corresponding summaries for the subset of the
     respective variables in 'x'.  If 'simplify' is true, summaries are
     simplified to vectors or matrices if they have a common length of
     one or greater than one, respectively; otherwise, lists of summary
     results according to subsets are obtained.  Rows with missing
     values in any of the 'by' variables will be omitted from the
     result.  (Note that versions of R prior to 2.11.0 required 'FUN'
     to be a scalar function.)

     The formula method provides a standard formula interface to
     'aggregate.data.frame'.  The latter invokes the formula method if
     'by' is a formula, in which case 'aggregate(x, by, FUN)' is the
     same as 'aggregate(by, x, FUN)' for a data frame 'x'.

     'aggregate.ts' is the time series method, and requires 'FUN' to be
     a scalar function.  If 'x' is not a time series, it is coerced to
     one.  Then, the variables in 'x' are split into appropriate blocks
     of length 'frequency(x) / nfrequency', and 'FUN' is applied to
     each such block, with further (named) arguments in '...' passed to
     it.  The result returned is a time series with frequency
     'nfrequency' holding the aggregated values.  Note that this make
     most sense for a quarterly or yearly result when the original
     series covers a whole number of quarters or years: in particular
     aggregating a monthly series to quarters starting in February does
     not give a conventional quarterly series.

     'FUN' is passed to 'match.fun', and hence it can be a function or
     a symbol or character string naming a function.

Value:

     For the time series method, a time series of class '"ts"' or class
     'c("mts", "ts")'.

     For the data frame method, a data frame with columns corresponding
     to the grouping variables in 'by' followed by aggregated columns
     from 'x'.  If the 'by' has names, the non-empty times are used to
     label the columns in the results, with unnamed grouping variables
     being named 'Group.i' for 'by[[i]]'.

Warning:

     The first argument of the '"formula"' method was named 'formula'
     rather than 'x' prior to R 4.2.0.  Portable uses should not name
     that argument.

Author(s):

     Kurt Hornik, with contributions by Arni Magnusson.

References:

     Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S
     Language_.  Wadsworth &amp; Brooks/Cole.

See Also:

     'apply', 'lapply', 'tapply'.

Examples:

     ## Compute the averages for the variables in 'state.x77', grouped
     ## according to the region (Northeast, South, North Central, West) that
     ## each state belongs to.
     aggregate(state.x77, list(Region = state.region), mean)
     
     ## Compute the averages according to region and the occurrence of more
     ## than 130 days of frost.
     aggregate(state.x77,
               list(Region = state.region,
                    Cold = state.x77[,"Frost"] &gt; 130),
               mean)
     ## (Note that no state in 'South' is THAT cold.)
     
     
     ## example with character variables and NAs
     testDF &lt;- data.frame(v1 = c(1,3,5,7,8,3,5,NA,4,5,7,9),
                          v2 = c(11,33,55,77,88,33,55,NA,44,55,77,99) )
     by1 &lt;- c("red", "blue", 1, 2, NA, "big", 1, 2, "red", 1, NA, 12)
     by2 &lt;- c("wet", "dry", 99, 95, NA, "damp", 95, 99, "red", 99, NA, NA)
     aggregate(x = testDF, by = list(by1, by2), FUN = "mean")
     
     # and if you want to treat NAs as a group
     fby1 &lt;- factor(by1, exclude = "")
     fby2 &lt;- factor(by2, exclude = "")
     aggregate(x = testDF, by = list(fby1, fby2), FUN = "mean")
     
     
     ## Formulas, one ~ one, one ~ many, many ~ one, and many ~ many:
     aggregate(weight ~ feed, data = chickwts, mean)
     aggregate(breaks ~ wool + tension, data = warpbreaks, mean)
     aggregate(cbind(Ozone, Temp) ~ Month, data = airquality, mean)
     aggregate(cbind(ncases, ncontrols) ~ alcgp + tobgp, data = esoph, sum)
     
     ## Dot notation:
     aggregate(. ~ Species, data = iris, mean)
     aggregate(len ~ ., data = ToothGrowth, mean)
     
     ## Often followed by xtabs():
     ag &lt;- aggregate(len ~ ., data = ToothGrowth, mean)
     xtabs(len ~ ., data = ag)
     
     ## Formula interface via 'by' (for pipe operations)
     ToothGrowth |&gt; aggregate(len ~ ., FUN = mean)
     
     ## Compute the average annual approval ratings for American presidents.
     aggregate(presidents, nfrequency = 1, FUN = mean)
     ## Give the summer less weight.
     aggregate(presidents, nfrequency = 1,
               FUN = weighted.mean, w = c(1, 1, 0.5, 1))</code></pre>
</div>
</div>
</section>
<section id="grouped-analyses-1" class="slide level2">
<h2>Grouped analyses</h2>
<ul>
<li>Let’s calculate seropositivity rate across age groups using the variables we just created.</li>
<li>The easiest way to use <code>aggregate()</code> is with the formula option. The syntax is <code>variable_of_intest ~ grouping_variables</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">aggregate</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="co"># Formula specifies we are calculating statistics on seropos, separately for</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="co"># each level of age_group</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>    seropos <span class="sc">~</span> age_group,</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="at">data =</span> df, <span class="co"># Data argument</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="at">FUN =</span> mean <span class="co"># function for our calculation WITHOUT PARENTHESES</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">seropos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: right;">0.1832797</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: right;">0.6000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">0.7945205</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>We can add as many things as we want on the RHS of the formula.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">aggregate</span>(</span>
<span id="cb11-2"><a href="#cb11-2"></a>    IgG_concentration <span class="sc">~</span> age_group <span class="sc">+</span> slum,</span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="at">data =</span> df,</span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="at">FUN =</span> sd <span class="co"># standard deviation</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">age_group</th>
<th style="text-align: left;">slum</th>
<th style="text-align: right;">IgG_concentration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: right;">174.89797</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: right;">162.08188</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: right;">150.07063</td>
</tr>
<tr class="even">
<td style="text-align: left;">young</td>
<td style="text-align: left;">Non slum</td>
<td style="text-align: right;">114.68422</td>
</tr>
<tr class="odd">
<td style="text-align: left;">middle</td>
<td style="text-align: left;">Non slum</td>
<td style="text-align: right;">177.62113</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">Non slum</td>
<td style="text-align: right;">141.22330</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">Slum</td>
<td style="text-align: right;">61.85705</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: left;">Slum</td>
<td style="text-align: right;">202.42018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: left;">Slum</td>
<td style="text-align: right;">74.75217</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>We can also add multiple variables on the LHS at the same time using <code>cbind()</code> syntax.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">aggregate</span>(</span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="fu">cbind</span>(age, IgG_concentration) <span class="sc">~</span> gender <span class="sc">+</span> slum,</span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="at">data =</span> df,</span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="at">FUN =</span> median</span>
<span id="cb12-5"><a href="#cb12-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">gender</th>
<th style="text-align: left;">slum</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">IgG_concentration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0117423</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2082192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Non slum</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.5040431</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Non slum</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.1245846</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Slum</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.1482480</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Slum</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">0.7753834</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="variable-contingency-tables" class="slide level2">
<h2>2 variable contingency tables</h2>
<p>We use <code>table()</code> prior to look at one variable, now we can generate frequency tables for 2 plus variables. To get cell percentages, the <code>prop.table()</code> is useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>?prop.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(printr)</span>
<span id="cb14-2"><a href="#cb14-2"></a>?prop.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Express Table Entries as Fraction of Marginal Table

Description:

     Returns conditional proportions given 'margins', i.e. entries of
     'x', divided by the appropriate marginal sums.

Usage:

     proportions(x, margin = NULL)
     prop.table(x, margin = NULL)
     
Arguments:

       x: table

  margin: a vector giving the margins to split by.  E.g., for a matrix
          '1' indicates rows, '2' indicates columns, 'c(1, 2)'
          indicates rows and columns.  When 'x' has named dimnames, it
          can be a character vector selecting dimension names.

Value:

     Table like 'x' expressed relative to 'margin'

Note:

     'prop.table' is an earlier name, retained for back-compatibility.

Author(s):

     Peter Dalgaard

See Also:

     'marginSums'. 'apply', 'sweep' are a more general mechanism for
     sweeping out marginal statistics.

Examples:

     m &lt;- matrix(1:4, 2)
     m
     proportions(m, 1)
     
     DF &lt;- as.data.frame(UCBAdmissions)
     tbl &lt;- xtabs(Freq ~ Gender + Admit, DF)
     
     proportions(tbl, "Gender")</code></pre>
</div>
</div>
</section>
<section id="variable-contingency-tables-1" class="slide level2">
<h2>2 variable contingency tables</h2>
<p>Let’s practice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>age_group, df<span class="sc">$</span>seropos)</span>
<span id="cb16-2"><a href="#cb16-2"></a>freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">/</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: right;">254</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">116</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, lets move to percentages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>prop.cell.percentages <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(freq)</span>
<span id="cb17-2"><a href="#cb17-2"></a>prop.cell.percentages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">/</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: right;">0.4018987</td>
<td style="text-align: right;">0.0901899</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: right;">0.1107595</td>
<td style="text-align: right;">0.1661392</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">0.0474684</td>
<td style="text-align: right;">0.1835443</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>prop.column.percentages <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(freq, <span class="at">margin=</span><span class="dv">2</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>prop.column.percentages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">/</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: right;">0.7175141</td>
<td style="text-align: right;">0.2050360</td>
</tr>
<tr class="even">
<td style="text-align: left;">middle</td>
<td style="text-align: right;">0.1977401</td>
<td style="text-align: right;">0.3776978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: right;">0.0847458</td>
<td style="text-align: right;">0.4172662</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="chi-square-test" class="slide level2">
<h2>Chi-Square test</h2>
<p>The <code>chisq.test()</code> function test of independence of factor variables from <code>stats</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>?chisq.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pearson’s Chi-squared Test for Count Data</p>
<p>Description:</p>
<pre><code> 'chisq.test' performs chi-squared contingency table tests and
 goodness-of-fit tests.</code></pre>
<p>Usage:</p>
<pre><code> chisq.test(x, y = NULL, correct = TRUE,
            p = rep(1/length(x), length(x)), rescale.p = FALSE,
            simulate.p.value = FALSE, B = 2000)
 </code></pre>
<p>Arguments:</p>
<pre><code>   x: a numeric vector or matrix. 'x' and 'y' can also both be
      factors.

   y: a numeric vector; ignored if 'x' is a matrix.  If 'x' is a
      factor, 'y' should be a factor of the same length.</code></pre>
<p>correct: a logical indicating whether to apply continuity correction when computing the test statistic for 2 by 2 tables: one half is subtracted from all |O - E| differences; however, the correction will not be bigger than the differences themselves. No correction is done if ‘simulate.p.value = TRUE’.</p>
<pre><code>   p: a vector of probabilities of the same length as 'x'.  An
      error is given if any entry of 'p' is negative.</code></pre>
<p>rescale.p: a logical scalar; if TRUE then ‘p’ is rescaled (if necessary) to sum to 1. If ‘rescale.p’ is FALSE, and ‘p’ does not sum to 1, an error is given.</p>
<p>simulate.p.value: a logical indicating whether to compute p-values by Monte Carlo simulation.</p>
<pre><code>   B: an integer specifying the number of replicates used in the
      Monte Carlo test.</code></pre>
<p>Details:</p>
<pre><code> If 'x' is a matrix with one row or column, or if 'x' is a vector
 and 'y' is not given, then a _goodness-of-fit test_ is performed
 ('x' is treated as a one-dimensional contingency table).  The
 entries of 'x' must be non-negative integers.  In this case, the
 hypothesis tested is whether the population probabilities equal
 those in 'p', or are all equal if 'p' is not given.

 If 'x' is a matrix with at least two rows and columns, it is taken
 as a two-dimensional contingency table: the entries of 'x' must be
 non-negative integers.  Otherwise, 'x' and 'y' must be vectors or
 factors of the same length; cases with missing values are removed,
 the objects are coerced to factors, and the contingency table is
 computed from these.  Then Pearson's chi-squared test is performed
 of the null hypothesis that the joint distribution of the cell
 counts in a 2-dimensional contingency table is the product of the
 row and column marginals.

 If 'simulate.p.value' is 'FALSE', the p-value is computed from the
 asymptotic chi-squared distribution of the test statistic;
 continuity correction is only used in the 2-by-2 case (if
 'correct' is 'TRUE', the default).  Otherwise the p-value is
 computed for a Monte Carlo test (Hope, 1968) with 'B' replicates.
 The default 'B = 2000' implies a minimum p-value of about 0.0005
 (1/(B+1)).

 In the contingency table case, simulation is done by random
 sampling from the set of all contingency tables with given
 marginals, and works only if the marginals are strictly positive.
 Continuity correction is never used, and the statistic is quoted
 without it.  Note that this is not the usual sampling situation
 assumed for the chi-squared test but rather that for Fisher's
 exact test.

 In the goodness-of-fit case simulation is done by random sampling
 from the discrete distribution specified by 'p', each sample being
 of size 'n = sum(x)'.  This simulation is done in R and may be
 slow.</code></pre>
<p>Value:</p>
<pre><code> A list with class '"htest"' containing the following components:</code></pre>
<p>statistic: the value the chi-squared test statistic.</p>
<p>parameter: the degrees of freedom of the approximate chi-squared distribution of the test statistic, ‘NA’ if the p-value is computed by Monte Carlo simulation.</p>
<p>p.value: the p-value for the test.</p>
<p>method: a character string indicating the type of test performed, and whether Monte Carlo simulation or continuity correction was used.</p>
<p>data.name: a character string giving the name(s) of the data.</p>
<p>observed: the observed counts.</p>
<p>expected: the expected counts under the null hypothesis.</p>
<p>residuals: the Pearson residuals, ‘(observed - expected) / sqrt(expected)’.</p>
<p>stdres: standardized residuals, ‘(observed - expected) / sqrt(V)’, where ‘V’ is the residual cell variance (Agresti, 2007, section 2.4.5 for the case where ‘x’ is a matrix, ‘n * p * (1 - p)’ otherwise).</p>
<p>Source:</p>
<pre><code> The code for Monte Carlo simulation is a C translation of the
 Fortran algorithm of Patefield (1981).</code></pre>
<p>References:</p>
<pre><code> Hope, A. C. A. (1968).  A simplified Monte Carlo significance test
 procedure.  _Journal of the Royal Statistical Society Series B_,
 *30*, 582-598.  doi:10.1111/j.2517-6161.1968.tb00759.x
 &lt;https://doi.org/10.1111/j.2517-6161.1968.tb00759.x&gt;.

 Patefield, W. M. (1981).  Algorithm AS 159: An efficient method of
 generating r x c tables with given row and column totals.
 _Applied Statistics_, *30*, 91-97.  doi:10.2307/2346669
 &lt;https://doi.org/10.2307/2346669&gt;.

 Agresti, A. (2007).  _An Introduction to Categorical Data
 Analysis_, 2nd ed.  New York: John Wiley &amp; Sons.  Page 38.</code></pre>
<p>See Also:</p>
<pre><code> For goodness-of-fit testing, notably of continuous distributions,
 'ks.test'.</code></pre>
<p>Examples:</p>
<pre><code> ## From Agresti(2007) p.39
 M &lt;- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))
 dimnames(M) &lt;- list(gender = c("F", "M"),
                     party = c("Democrat","Independent", "Republican"))
 (Xsq &lt;- chisq.test(M))  # Prints test summary
 Xsq$observed   # observed counts (same as M)
 Xsq$expected   # expected counts under the null
 Xsq$residuals  # Pearson residuals
 Xsq$stdres     # standardized residuals
 
 
 ## Effect of simulating p-values
 x &lt;- matrix(c(12, 5, 7, 7), ncol = 2)
 chisq.test(x)$p.value           # 0.4233
 chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value
                                 # around 0.29!
 
 ## Testing for population probabilities
 ## Case A. Tabulated data
 x &lt;- c(A = 20, B = 15, C = 25)
 chisq.test(x)
 chisq.test(as.table(x))             # the same
 x &lt;- c(89,37,30,28,2)
 p &lt;- c(40,20,20,15,5)
 try(
 chisq.test(x, p = p)                # gives an error
 )
 chisq.test(x, p = p, rescale.p = TRUE)
                                 # works
 p &lt;- c(0.40,0.20,0.20,0.19,0.01)
                                 # Expected count in category 5
                                 # is 1.86 &lt; 5 ==&gt; chi square approx.
 chisq.test(x, p = p)            #               maybe doubtful, but is ok!
 chisq.test(x, p = p, simulate.p.value = TRUE)
 
 ## Case B. Raw data
 x &lt;- trunc(5 * runif(100))
 chisq.test(table(x))            # NOT 'chisq.test(x)'!</code></pre>
</section>
<section id="chi-square-test-1" class="slide level2">
<h2>Chi-Square test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">chisq.test</span>(freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  freq
X-squared = 175.85, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We reject the null hypothesis that the proportion of seropositive individuals in the young, middle, and old age groups are the same.</p>
</section>
<section id="correlation" class="slide level2">
<h2>Correlation</h2>
<p>First, we compute correlation by providing two vectors.</p>
<p>Like other functions, if there are <code>NA</code>s, you get <code>NA</code> as the result. But if you specify use only the complete observations, then it will give you correlation using the non-missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>age, df<span class="sc">$</span>IgG_concentration, <span class="at">method=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>age, df<span class="sc">$</span>IgG_concentration, <span class="at">method=</span><span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"complete.obs"</span>) <span class="co">#IF have missing data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2604783</code></pre>
</div>
</div>
<p>Small positive correlation between IgG concentration and age.</p>
</section>
<section id="correlation-confidence-interval" class="slide level2">
<h2>Correlation confidence interval</h2>
<p>The function <code>cor.test()</code> also gives you the confidence interval of the correlation statistic. Note, it uses complete observations by default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>age, df<span class="sc">$</span>IgG_concentration, <span class="at">method=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  df$age and df$IgG_concentration
t = 6.7717, df = 630, p-value = 2.921e-11
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1862722 0.3317295
sample estimates:
      cor 
0.2604783 </code></pre>
</div>
</div>
</section>
<section id="t-test" class="slide level2">
<h2>T-test</h2>
<p>The commonly used are:</p>
<ul>
<li><strong>one-sample t-test</strong> – used to test mean of a variable in one group (to the null hypothesis mean)</li>
<li><strong>two-sample t-test</strong> – used to test difference in means of a variable between two groups (null hypothesis - the group means are the <em>same</em>)</li>
</ul>
</section>
<section id="t-test-1" class="slide level2">
<h2>T-test</h2>
<p>We can use the <code>t.test()</code> function from the <code>stats</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>?t.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Student’s t-Test</p>
<p>Description:</p>
<pre><code> Performs one and two sample t-tests on vectors of data.</code></pre>
<p>Usage:</p>
<pre><code> t.test(x, ...)
 
 ## Default S3 method:
 t.test(x, y = NULL,
        alternative = c("two.sided", "less", "greater"),
        mu = 0, paired = FALSE, var.equal = FALSE,
        conf.level = 0.95, ...)
 
 ## S3 method for class 'formula'
 t.test(formula, data, subset, na.action, ...)
 </code></pre>
<p>Arguments:</p>
<pre><code>   x: a (non-empty) numeric vector of data values.

   y: an optional (non-empty) numeric vector of data values.</code></pre>
<p>alternative: a character string specifying the alternative hypothesis, must be one of ‘“two.sided”’ (default), ‘“greater”’ or ‘“less”’. You can specify just the initial letter.</p>
<pre><code>  mu: a number indicating the true value of the mean (or difference
      in means if you are performing a two sample test).</code></pre>
<p>paired: a logical indicating whether you want a paired t-test.</p>
<p>var.equal: a logical variable indicating whether to treat the two variances as being equal. If ‘TRUE’ then the pooled variance is used to estimate the variance otherwise the Welch (or Satterthwaite) approximation to the degrees of freedom is used.</p>
<p>conf.level: confidence level of the interval.</p>
<p>formula: a formula of the form ‘lhs ~ rhs’ where ‘lhs’ is a numeric variable giving the data values and ‘rhs’ either ‘1’ for a one-sample or paired test or a factor with two levels giving the corresponding groups. If ‘lhs’ is of class ‘“Pair”’ and ‘rhs’ is ‘1’, a paired test is done.</p>
<pre><code>data: an optional matrix or data frame (or similar: see
      'model.frame') containing the variables in the formula
      'formula'.  By default the variables are taken from
      'environment(formula)'.</code></pre>
<p>subset: an optional vector specifying a subset of observations to be used.</p>
<p>na.action: a function which indicates what should happen when the data contain ‘NA’s. Defaults to ’getOption(“na.action”)’.</p>
<pre><code> ...: further arguments to be passed to or from methods.</code></pre>
<p>Details:</p>
<pre><code> 'alternative = "greater"' is the alternative that 'x' has a larger
 mean than 'y'. For the one-sample case: that the mean is positive.

 If 'paired' is 'TRUE' then both 'x' and 'y' must be specified and
 they must be the same length.  Missing values are silently removed
 (in pairs if 'paired' is 'TRUE').  If 'var.equal' is 'TRUE' then
 the pooled estimate of the variance is used.  By default, if
 'var.equal' is 'FALSE' then the variance is estimated separately
 for both groups and the Welch modification to the degrees of
 freedom is used.

 If the input data are effectively constant (compared to the larger
 of the two means) an error is generated.</code></pre>
<p>Value:</p>
<pre><code> A list with class '"htest"' containing the following components:</code></pre>
<p>statistic: the value of the t-statistic.</p>
<p>parameter: the degrees of freedom for the t-statistic.</p>
<p>p.value: the p-value for the test.</p>
<p>conf.int: a confidence interval for the mean appropriate to the specified alternative hypothesis.</p>
<p>estimate: the estimated mean or difference in means depending on whether it was a one-sample test or a two-sample test.</p>
<p>null.value: the specified hypothesized value of the mean or mean difference depending on whether it was a one-sample test or a two-sample test.</p>
<p>stderr: the standard error of the mean (difference), used as denominator in the t-statistic formula.</p>
<p>alternative: a character string describing the alternative hypothesis.</p>
<p>method: a character string indicating what type of t-test was performed.</p>
<p>data.name: a character string giving the name(s) of the data.</p>
<p>See Also:</p>
<pre><code> 'prop.test'</code></pre>
<p>Examples:</p>
<pre><code> require(graphics)
 
 t.test(1:10, y = c(7:20))      # P = .00001855
 t.test(1:10, y = c(7:20, 200)) # P = .1245    -- NOT significant anymore
 
 ## Classical example: Student's sleep data
 plot(extra ~ group, data = sleep)
 ## Traditional interface
 with(sleep, t.test(extra[group == 1], extra[group == 2]))
 
 ## Formula interface
 t.test(extra ~ group, data = sleep)
 
 ## Formula interface to one-sample test
 t.test(extra ~ 1, data = sleep)
 
 ## Formula interface to paired test
 ## The sleep data are actually paired, so could have been in wide format:
 sleep2 &lt;- reshape(sleep, direction = "wide", 
                   idvar = "ID", timevar = "group")
 t.test(Pair(extra.1, extra.2) ~ 1, data = sleep2)</code></pre>
</section>
<section id="running-two-sample-t-test" class="slide level2">
<h2>Running two-sample t-test</h2>
<p>The <strong>base R</strong> - <code>t.test()</code> function from the <code>stats</code> package. It tests test difference in means of a variable between two groups. By default:</p>
<ul>
<li>tests whether difference in means of a variable is equal to 0 (default <code>mu=0</code>)</li>
<li>uses “two sided” alternative (<code>alternative = "two.sided"</code>)</li>
<li>returns result assuming confidence level 0.95 (<code>conf.level = 0.95</code>)</li>
<li>assumes data are not paired (<code>paired = FALSE</code>)</li>
<li>assumes true variance in the two groups is not equal (<code>var.equal = FALSE</code>)</li>
</ul>
</section>
<section id="running-two-sample-t-test-1" class="slide level2">
<h2>Running two-sample t-test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>IgG_young <span class="ot">&lt;-</span> df<span class="sc">$</span>IgG_concentration[df<span class="sc">$</span>age_group<span class="sc">==</span><span class="st">"young"</span>]</span>
<span id="cb50-2"><a href="#cb50-2"></a>IgG_old <span class="ot">&lt;-</span> df<span class="sc">$</span>IgG_concentration[df<span class="sc">$</span>age_group<span class="sc">==</span><span class="st">"old"</span>]</span>
<span id="cb50-3"><a href="#cb50-3"></a></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="fu">t.test</span>(IgG_young, IgG_old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  IgG_young and IgG_old
t = -6.1969, df = 259.54, p-value = 2.25e-09
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -111.09281  -57.51515
sample estimates:
mean of x mean of y 
 45.05056 129.35454 </code></pre>
</div>
</div>
<p>The mean IgG concenration of young and old is 45.05 and 129.35 IU/mL, respectively. We reject null hypothesis that the difference in the mean IgG concentration of young and old is 0 IU/mL.</p>
</section>
<section id="linear-regression-fit-in-r" class="slide level2">
<h2>Linear regression fit in R</h2>
<p>To fit regression models in R, we use the function <code>glm()</code> (Generalized Linear Model).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>?glm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fitting Generalized Linear Models</p>
<p>Description:</p>
<pre><code> 'glm' is used to fit generalized linear models, specified by
 giving a symbolic description of the linear predictor and a
 description of the error distribution.</code></pre>
<p>Usage:</p>
<pre><code> glm(formula, family = gaussian, data, weights, subset,
     na.action, start = NULL, etastart, mustart, offset,
     control = list(...), model = TRUE, method = "glm.fit",
     x = FALSE, y = TRUE, singular.ok = TRUE, contrasts = NULL, ...)
 
 glm.fit(x, y, weights = rep.int(1, nobs),
         start = NULL, etastart = NULL, mustart = NULL,
         offset = rep.int(0, nobs), family = gaussian(),
         control = list(), intercept = TRUE, singular.ok = TRUE)
 
 ## S3 method for class 'glm'
 weights(object, type = c("prior", "working"), ...)
 </code></pre>
<p>Arguments:</p>
<p>formula: an object of class ‘“formula”’ (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
<p>family: a description of the error distribution and link function to be used in the model. For ‘glm’ this can be a character string naming a family function, a family function or the result of a call to a family function. For ‘glm.fit’ only the third option is supported. (See ‘family’ for details of family functions.)</p>
<pre><code>data: an optional data frame, list or environment (or object
      coercible by 'as.data.frame' to a data frame) containing the
      variables in the model.  If not found in 'data', the
      variables are taken from 'environment(formula)', typically
      the environment from which 'glm' is called.</code></pre>
<p>weights: an optional vector of ‘prior weights’ to be used in the fitting process. Should be ‘NULL’ or a numeric vector.</p>
<p>subset: an optional vector specifying a subset of observations to be used in the fitting process.</p>
<p>na.action: a function which indicates what should happen when the data contain ‘NA’s. The default is set by the ’na.action’ setting of ‘options’, and is ‘na.fail’ if that is unset. The ‘factory-fresh’ default is ‘na.omit’. Another possible value is ‘NULL’, no action. Value ‘na.exclude’ can be useful.</p>
<p>start: starting values for the parameters in the linear predictor.</p>
<p>etastart: starting values for the linear predictor.</p>
<p>mustart: starting values for the vector of means.</p>
<p>offset: this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be ‘NULL’ or a numeric vector of length equal to the number of cases. One or more ‘offset’ terms can be included in the formula instead or as well, and if more than one is specified their sum is used. See ‘model.offset’.</p>
<p>control: a list of parameters for controlling the fitting process. For ‘glm.fit’ this is passed to ‘glm.control’.</p>
<p>model: a logical value indicating whether <em>model frame</em> should be included as a component of the returned value.</p>
<p>method: the method to be used in fitting the model. The default method ‘“glm.fit”’ uses iteratively reweighted least squares (IWLS): the alternative ‘“model.frame”’ returns the model frame and does no fitting.</p>
<pre><code>      User-supplied fitting functions can be supplied either as a
      function or a character string naming a function, with a
      function which takes the same arguments as 'glm.fit'.  If
      specified as a character string it is looked up from within
      the 'stats' namespace.

x, y: For 'glm': logical values indicating whether the response
      vector and model matrix used in the fitting process should be
      returned as components of the returned value.

      For 'glm.fit': 'x' is a design matrix of dimension 'n * p',
      and 'y' is a vector of observations of length 'n'.</code></pre>
<p>singular.ok: logical; if ‘FALSE’ a singular fit is an error.</p>
<p>contrasts: an optional list. See the ‘contrasts.arg’ of ‘model.matrix.default’.</p>
<p>intercept: logical. Should an intercept be included in the <em>null</em> model?</p>
<p>object: an object inheriting from class ‘“glm”’.</p>
<pre><code>type: character, partial matching allowed.  Type of weights to
      extract from the fitted model object.  Can be abbreviated.

 ...: For 'glm': arguments to be used to form the default 'control'
      argument if it is not supplied directly.

      For 'weights': further arguments passed to or from other
      methods.</code></pre>
<p>Details:</p>
<pre><code> A typical predictor has the form 'response ~ terms' where
 'response' is the (numeric) response vector and 'terms' is a
 series of terms which specifies a linear predictor for 'response'.
 For 'binomial' and 'quasibinomial' families the response can also
 be specified as a 'factor' (when the first level denotes failure
 and all others success) or as a two-column matrix with the columns
 giving the numbers of successes and failures.  A terms
 specification of the form 'first + second' indicates all the terms
 in 'first' together with all the terms in 'second' with any
 duplicates removed.

 A specification of the form 'first:second' indicates the set of
 terms obtained by taking the interactions of all terms in 'first'
 with all terms in 'second'.  The specification 'first*second'
 indicates the _cross_ of 'first' and 'second'.  This is the same
 as 'first + second + first:second'.

 The terms in the formula will be re-ordered so that main effects
 come first, followed by the interactions, all second-order, all
 third-order and so on: to avoid this pass a 'terms' object as the
 formula.

 Non-'NULL' 'weights' can be used to indicate that different
 observations have different dispersions (with the values in
 'weights' being inversely proportional to the dispersions); or
 equivalently, when the elements of 'weights' are positive integers
 w_i, that each response y_i is the mean of w_i unit-weight
 observations.  For a binomial GLM prior weights are used to give
 the number of trials when the response is the proportion of
 successes: they would rarely be used for a Poisson GLM.

 'glm.fit' is the workhorse function: it is not normally called
 directly but can be more efficient where the response vector,
 design matrix and family have already been calculated.

 If more than one of 'etastart', 'start' and 'mustart' is
 specified, the first in the list will be used.  It is often
 advisable to supply starting values for a 'quasi' family, and also
 for families with unusual links such as 'gaussian("log")'.

 All of 'weights', 'subset', 'offset', 'etastart' and 'mustart' are
 evaluated in the same way as variables in 'formula', that is first
 in 'data' and then in the environment of 'formula'.

 For the background to warning messages about 'fitted probabilities
 numerically 0 or 1 occurred' for binomial GLMs, see Venables &amp;
 Ripley (2002, pp. 197-8).</code></pre>
<p>Value:</p>
<pre><code> 'glm' returns an object of class inheriting from '"glm"' which
 inherits from the class '"lm"'. See later in this section.  If a
 non-standard 'method' is used, the object will also inherit from
 the class (if any) returned by that function.

 The function 'summary' (i.e., 'summary.glm') can be used to obtain
 or print a summary of the results and the function 'anova' (i.e.,
 'anova.glm') to produce an analysis of variance table.

 The generic accessor functions 'coefficients', 'effects',
 'fitted.values' and 'residuals' can be used to extract various
 useful features of the value returned by 'glm'.

 'weights' extracts a vector of weights, one for each case in the
 fit (after subsetting and 'na.action').

 An object of class '"glm"' is a list containing at least the
 following components:</code></pre>
<p>coefficients: a named vector of coefficients</p>
<p>residuals: the <em>working</em> residuals, that is the residuals in the final iteration of the IWLS fit. Since cases with zero weights are omitted, their working residuals are ‘NA’.</p>
<p>fitted.values: the fitted mean values, obtained by transforming the linear predictors by the inverse of the link function.</p>
<pre><code>rank: the numeric rank of the fitted linear model.</code></pre>
<p>family: the ‘family’ object used.</p>
<p>linear.predictors: the linear fit on link scale.</p>
<p>deviance: up to a constant, minus twice the maximized log-likelihood. Where sensible, the constant is chosen so that a saturated model has deviance zero.</p>
<pre><code> aic: A version of Akaike's _An Information Criterion_, minus twice
      the maximized log-likelihood plus twice the number of
      parameters, computed via the 'aic' component of the family.
      For binomial and Poison families the dispersion is fixed at
      one and the number of parameters is the number of
      coefficients.  For gaussian, Gamma and inverse gaussian
      families the dispersion is estimated from the residual
      deviance, and the number of parameters is the number of
      coefficients plus one.  For a gaussian family the MLE of the
      dispersion is used so this is a valid value of AIC, but for
      Gamma and inverse gaussian families it is not.  For families
      fitted by quasi-likelihood the value is 'NA'.</code></pre>
<p>null.deviance: The deviance for the null model, comparable with ‘deviance’. The null model will include the offset, and an intercept if there is one in the model. Note that this will be incorrect if the link function depends on the data other than through the fitted mean: specify a zero offset to force a correct calculation.</p>
<pre><code>iter: the number of iterations of IWLS used.</code></pre>
<p>weights: the <em>working</em> weights, that is the weights in the final iteration of the IWLS fit.</p>
<p>prior.weights: the weights initially supplied, a vector of ’1’s if none were.</p>
<p>df.residual: the residual degrees of freedom.</p>
<p>df.null: the residual degrees of freedom for the null model.</p>
<pre><code>   y: if requested (the default) the 'y' vector used. (It is a
      vector even for a binomial model.)

   x: if requested, the model matrix.</code></pre>
<p>model: if requested (the default), the model frame.</p>
<p>converged: logical. Was the IWLS algorithm judged to have converged?</p>
<p>boundary: logical. Is the fitted value on the boundary of the attainable values?</p>
<pre><code>call: the matched call.</code></pre>
<p>formula: the formula supplied.</p>
<p>terms: the ‘terms’ object used.</p>
<pre><code>data: the 'data argument'.</code></pre>
<p>offset: the offset vector used.</p>
<p>control: the value of the ‘control’ argument used.</p>
<p>method: the name of the fitter function used (when provided as a ‘character’ string to ‘glm()’) or the fitter ‘function’ (when provided as that).</p>
<p>contrasts: (where relevant) the contrasts used.</p>
<p>xlevels: (where relevant) a record of the levels of the factors used in fitting.</p>
<p>na.action: (where relevant) information returned by ‘model.frame’ on the special handling of ’NA’s.</p>
<pre><code> In addition, non-empty fits will have components 'qr', 'R' and
 'effects' relating to the final weighted linear fit.

 Objects of class '"glm"' are normally of class 'c("glm", "lm")',
 that is inherit from class '"lm"', and well-designed methods for
 class '"lm"' will be applied to the weighted linear model at the
 final iteration of IWLS.  However, care is needed, as extractor
 functions for class '"glm"' such as 'residuals' and 'weights' do
 *not* just pick out the component of the fit with the same name.

 If a 'binomial' 'glm' model was specified by giving a two-column
 response, the weights returned by 'prior.weights' are the total
 numbers of cases (factored by the supplied case weights) and the
 component 'y' of the result is the proportion of successes.</code></pre>
<p>Fitting functions:</p>
<pre><code> The argument 'method' serves two purposes.  One is to allow the
 model frame to be recreated with no fitting.  The other is to
 allow the default fitting function 'glm.fit' to be replaced by a
 function which takes the same arguments and uses a different
 fitting algorithm.  If 'glm.fit' is supplied as a character string
 it is used to search for a function of that name, starting in the
 'stats' namespace.

 The class of the object return by the fitter (if any) will be
 prepended to the class returned by 'glm'.</code></pre>
<p>Author(s):</p>
<pre><code> The original R implementation of 'glm' was written by Simon Davies
 working for Ross Ihaka at the University of Auckland, but has
 since been extensively re-written by members of the R Core team.

 The design was inspired by the S function of the same name
 described in Hastie &amp; Pregibon (1992).</code></pre>
<p>References:</p>
<pre><code> Dobson, A. J. (1990) _An Introduction to Generalized Linear
 Models._ London: Chapman and Hall.

 Hastie, T. J. and Pregibon, D. (1992) _Generalized linear models._
 Chapter 6 of _Statistical Models in S_ eds J. M. Chambers and T.
 J. Hastie, Wadsworth &amp; Brooks/Cole.

 McCullagh P. and Nelder, J. A. (1989) _Generalized Linear Models._
 London: Chapman and Hall.

 Venables, W. N. and Ripley, B. D. (2002) _Modern Applied
 Statistics with S._ New York: Springer.</code></pre>
<p>See Also:</p>
<pre><code> 'anova.glm', 'summary.glm', etc. for 'glm' methods, and the
 generic functions 'anova', 'summary', 'effects', 'fitted.values',
 and 'residuals'.

 'lm' for non-generalized _linear_ models (which SAS calls GLMs,
 for 'general' linear models).

 'loglin' and 'loglm' (package 'MASS') for fitting log-linear
 models (which binomial and Poisson GLMs are) to contingency
 tables.

 'bigglm' in package 'biglm' for an alternative way to fit GLMs to
 large datasets (especially those with many cases).

 'esoph', 'infert' and 'predict.glm' have examples of fitting
 binomial glms.</code></pre>
<p>Examples:</p>
<pre><code> ## Dobson (1990) Page 93: Randomized Controlled Trial :
 counts &lt;- c(18,17,15,20,10,20,25,13,12)
 outcome &lt;- gl(3,1,9)
 treatment &lt;- gl(3,3)
 data.frame(treatment, outcome, counts) # showing data
 glm.D93 &lt;- glm(counts ~ outcome + treatment, family = poisson())
 anova(glm.D93)
 summary(glm.D93)
 ## Computing AIC [in many ways]:
 (A0 &lt;- AIC(glm.D93))
 (ll &lt;- logLik(glm.D93))
 A1 &lt;- -2*c(ll) + 2*attr(ll, "df")
 A2 &lt;- glm.D93$family$aic(counts, mu=fitted(glm.D93), wt=1) +
         2 * length(coef(glm.D93))
 stopifnot(exprs = {
   all.equal(A0, A1)
   all.equal(A1, A2)
   all.equal(A1, glm.D93$aic)
 })
 
 
 ## an example with offsets from Venables &amp; Ripley (2002, p.189)
 utils::data(anorexia, package = "MASS")
 
 anorex.1 &lt;- glm(Postwt ~ Prewt + Treat + offset(Prewt),
                 family = gaussian, data = anorexia)
 summary(anorex.1)
 
 
 # A Gamma example, from McCullagh &amp; Nelder (1989, pp. 300-2)
 clotting &lt;- data.frame(
     u = c(5,10,15,20,30,40,60,80,100),
     lot1 = c(118,58,42,35,27,25,21,19,18),
     lot2 = c(69,35,26,21,18,16,13,12,12))
 summary(glm(lot1 ~ log(u), data = clotting, family = Gamma))
 summary(glm(lot2 ~ log(u), data = clotting, family = Gamma))
 ## Aliased ("S"ingular) -&gt; 1 NA coefficient
 (fS &lt;- glm(lot2 ~ log(u) + log(u^2), data = clotting, family = Gamma))
 tools::assertError(update(fS, singular.ok=FALSE), verbose=interactive())
 ## -&gt; .. "singular fit encountered"
 
 ## Not run:
 
 ## for an example of the use of a terms object as a formula
 demo(glm.vr)
 ## End(Not run)</code></pre>
</section>
<section id="linear-regression-fit-in-r-1" class="slide level2">
<h2>Linear regression fit in R</h2>
<p>We tend to focus on three arguments:</p>
<ul>
<li><code>formula</code> – model formula written using names of columns in our data</li>
<li><code>data</code> – our data frame</li>
<li><code>family</code> – error distribution and link function</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(IgG_concentration<span class="sc">~</span>age<span class="sc">+</span>gender<span class="sc">+</span>slum, <span class="at">data=</span>df, <span class="at">family=</span><span class="fu">gaussian</span>())</span>
<span id="cb72-2"><a href="#cb72-2"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(seropos<span class="sc">~</span>age_group<span class="sc">+</span>gender<span class="sc">+</span>slum, <span class="at">data=</span>df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary.glm" class="slide level2">
<h2><code>summary.glm()</code></h2>
<p>The <code>summary()</code> function when applied to a fit object based on a glm is technically the <code>summary.glm()</code> function and produces details of the model fit. Note on object oriented code.</p>

<img data-src="images/rstudio_script.png" style="width:200.0%" class="r-stretch"><p>Summarizing Generalized Linear Model Fits</p>
<p>Description:</p>
<pre><code> These functions are all 'methods' for class 'glm' or 'summary.glm'
 objects.</code></pre>
<p>Usage:</p>
<pre><code> ## S3 method for class 'glm'
 summary(object, dispersion = NULL, correlation = FALSE,
         symbolic.cor = FALSE, ...)
 
 ## S3 method for class 'summary.glm'
 print(x, digits = max(3, getOption("digits") - 3),
       symbolic.cor = x$symbolic.cor,
       signif.stars = getOption("show.signif.stars"),
       show.residuals = FALSE, ...)
 </code></pre>
<p>Arguments:</p>
<p>object: an object of class ‘“glm”’, usually, a result of a call to ‘glm’.</p>
<pre><code>   x: an object of class '"summary.glm"', usually, a result of a
      call to 'summary.glm'.</code></pre>
<p>dispersion: the dispersion parameter for the family used. Either a single numerical value or ‘NULL’ (the default), when it is inferred from ‘object’ (see ‘Details’).</p>
<p>correlation: logical; if ‘TRUE’, the correlation matrix of the estimated parameters is returned and printed.</p>
<p>digits: the number of significant digits to use when printing.</p>
<p>symbolic.cor: logical. If ‘TRUE’, print the correlations in a symbolic form (see ‘symnum’) rather than as numbers.</p>
<p>signif.stars: logical. If ‘TRUE’, ‘significance stars’ are printed for each coefficient.</p>
<p>show.residuals: logical. If ‘TRUE’ then a summary of the deviance residuals is printed at the head of the output.</p>
<pre><code> ...: further arguments passed to or from other methods.</code></pre>
<p>Details:</p>
<pre><code> 'print.summary.glm' tries to be smart about formatting the
 coefficients, standard errors, etc. and additionally gives
 'significance stars' if 'signif.stars' is 'TRUE'.  The
 'coefficients' component of the result gives the estimated
 coefficients and their estimated standard errors, together with
 their ratio.  This third column is labelled 't ratio' if the
 dispersion is estimated, and 'z ratio' if the dispersion is known
 (or fixed by the family).  A fourth column gives the two-tailed
 p-value corresponding to the t or z ratio based on a Student t or
 Normal reference distribution.  (It is possible that the
 dispersion is not known and there are no residual degrees of
 freedom from which to estimate it.  In that case the estimate is
 'NaN'.)

 Aliased coefficients are omitted in the returned object but
 restored by the 'print' method.

 Correlations are printed to two decimal places (or symbolically):
 to see the actual correlations print 'summary(object)$correlation'
 directly.

 The dispersion of a GLM is not used in the fitting process, but it
 is needed to find standard errors.  If 'dispersion' is not
 supplied or 'NULL', the dispersion is taken as '1' for the
 'binomial' and 'Poisson' families, and otherwise estimated by the
 residual Chisquared statistic (calculated from cases with non-zero
 weights) divided by the residual degrees of freedom.

 'summary' can be used with Gaussian 'glm' fits to handle the case
 of a linear regression with known error variance, something not
 handled by 'summary.lm'.</code></pre>
<p>Value:</p>
<pre><code> 'summary.glm' returns an object of class '"summary.glm"', a list
 with components

call: the component from 'object'.</code></pre>
<p>family: the component from ‘object’.</p>
<p>deviance: the component from ‘object’.</p>
<p>contrasts: the component from ‘object’.</p>
<p>df.residual: the component from ‘object’.</p>
<p>null.deviance: the component from ‘object’.</p>
<p>df.null: the component from ‘object’.</p>
<p>deviance.resid: the deviance residuals: see ‘residuals.glm’.</p>
<p>coefficients: the matrix of coefficients, standard errors, z-values and p-values. Aliased coefficients are omitted.</p>
<p>aliased: named logical vector showing if the original coefficients are aliased.</p>
<p>dispersion: either the supplied argument or the inferred/estimated dispersion if the former is ‘NULL’.</p>
<pre><code>  df: a 3-vector of the rank of the model and the number of
      residual degrees of freedom, plus number of coefficients
      (including aliased ones).</code></pre>
<p>cov.unscaled: the unscaled (‘dispersion = 1’) estimated covariance matrix of the estimated coefficients.</p>
<p>cov.scaled: ditto, scaled by ‘dispersion’.</p>
<p>correlation: (only if ‘correlation’ is true.) The estimated correlations of the estimated coefficients.</p>
<p>symbolic.cor: (only if ‘correlation’ is true.) The value of the argument ‘symbolic.cor’.</p>
<p>See Also:</p>
<pre><code> 'glm', 'summary'.</code></pre>
<p>Examples:</p>
<pre><code> ## For examples see example(glm)</code></pre>
</section>
<section id="linear-regression-fit-in-r-2" class="slide level2">
<h2>Linear regression fit in R</h2>
<p>Lets look at the output…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = IgG_concentration ~ age + gender + slum, family = gaussian(), 
    data = df)

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    46.132     16.774   2.750  0.00613 ** 
age             9.324      1.388   6.718 4.15e-11 ***
genderMale     -9.655     11.543  -0.836  0.40321    
slumNon slum  -20.353     14.299  -1.423  0.15513    
slumSlum      -29.705     25.009  -1.188  0.23536    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 20918.39)

    Null deviance: 14141483  on 631  degrees of freedom
Residual deviance: 13115831  on 627  degrees of freedom
  (19 observations deleted due to missingness)
AIC: 8087.9

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = seropos ~ age_group + gender + slum, family = binomial(link = "logit"), 
    data = df)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      -1.3220     0.2516  -5.254 1.49e-07 ***
age_groupmiddle   1.9020     0.2133   8.916  &lt; 2e-16 ***
age_groupold      2.8443     0.2522  11.278  &lt; 2e-16 ***
genderMale       -0.1725     0.1895  -0.910    0.363    
slumNon slum     -0.1099     0.2329  -0.472    0.637    
slumSlum         -0.1073     0.4118  -0.261    0.794    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 866.98  on 631  degrees of freedom
Residual deviance: 679.10  on 626  degrees of freedom
  (19 observations deleted due to missingness)
AIC: 691.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>the <code>aggregate()</code> function can be used to conduct analyses across groups (i.e., categorical variables in the data(</li>
<li>the <code>table()</code> function can generate frequency tables for 2 plus variables, but to get percentage tables, the <code>prop.table()</code> is useful</li>
<li>the <code>chisq.test()</code> function tests independence of factor variables</li>
<li>the <code>cor()</code> or <code>cor.test()</code> functions can be used to calculate correlation between two numeric vectors</li>
<li>the <code>t.test()</code> functions conducts one and two sample (paired or unpaired) t-tests</li>
<li>the function <code>glm()</code> fits generalized linear modules to data and returns a fit object that can be read with the <code>summary()</code> function</li>
<li>changing the <code>family</code> argument in the <code>glm()</code> function allows you to fit models with different link functions</li>
</ul>
</section>
<section id="acknowledgements" class="slide level2">
<h2>Acknowledgements</h2>
<p>These are the materials we looked through, modified, or extracted to complete this module’s lecture.</p>
<ul>
<li><a href="https://jhudatascience.org/intro_to_r/">“Introduction to R for Public Health Researchers” Johns Hopkins University</a></li>
</ul>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>